(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{17:function(e,t,n){e.exports=n(40)},40:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(16),c=n.n(o),u=n(6),l=n(2),i=n.n(l),s=n(4),m=n(1),d=function(e){var t=e.onBlogAdd,n=Object(a.useState)(""),o=Object(m.a)(n,2),c=o[0],u=o[1],l=Object(a.useState)(""),i=Object(m.a)(l,2),s=i[0],d=i[1],p=Object(a.useState)(""),b=Object(m.a)(p,2),f=b[0],v=b[1];return r.a.createElement("div",null,r.a.createElement("h2",null,"Create your own blog!"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t({title:c,author:s,url:f}),d(""),v(""),u("")}},r.a.createElement("div",null,"title:",r.a.createElement("input",{id:"title",type:"text",value:c,name:"Title",onChange:function(e){var t=e.target;return u(t.value)}})),r.a.createElement("div",null,"author",r.a.createElement("input",{id:"author",type:"text",value:s,name:"Author",onChange:function(e){var t=e.target;return d(t.value)}})),r.a.createElement("div",null,"url",r.a.createElement("input",{id:"url",type:"text",value:f,name:"Url",onChange:function(e){var t=e.target;return v(t.value)}})),r.a.createElement("button",{type:"submit"},"create")))},p=n(5),b=n.n(p),f=null,v=function(){var e=Object(s.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:f}},e.next=3,b.a.post("/api/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(s.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:f}},e.next=3,b.a.delete("".concat("/api/blogs","/").concat(t),n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E={getAll:function(){return b.a.get("/api/blogs").then((function(e){return e.data.sort((function(e,t){return t.likes-e.likes}))}))},createBlog:v,setToken:function(e){f="bearer ".concat(e)},likeBlog:function(){var e=Object(s.a)(i.a.mark((function e(t,n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.put("".concat("/api/blogs","/").concat(t),n);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteBlog:g},h=function(e){var t=e.blog,n=e.reRenderAfterEvent,o=Object(a.useState)(!1),c=Object(m.a)(o,2),u=c[0],l=c[1],i=Object(a.useState)([]),s=Object(m.a)(i,2),d=s[0],p=s[1];Object(a.useEffect)((function(){var e=window.localStorage.getItem("user");if(e){var t=JSON.parse(e);p(t),E.setToken(t.token)}}),[]);var b=function(){l(!u)};return r.a.createElement("div",{style:{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},className:"blog"},u?r.a.createElement("div",{className:"blog-details"},r.a.createElement("p",null,t.title,r.a.createElement("button",{onClick:b},"hide")),r.a.createElement("p",null,t.url),r.a.createElement("p",{className:"liked"},t.likes,r.a.createElement("button",{onClick:function(){return function(e,t){var a={user:t.user.id,likes:++t.likes,author:t.author,title:t.title,url:t.url};E.likeBlog(e,a),n()}(t.id,t)}},"like")),r.a.createElement("p",null,t.author),d.id===t.user.id&&r.a.createElement("button",{onClick:function(){return function(e){window.confirm("Do you want to remove blog ".concat(e.title," by ").concat(e.author," ?"))&&E.deleteBlog(e.id)}(t)}},"Remove")):r.a.createElement("div",{className:"blog-overview"},t.title," ",t.author,r.a.createElement("button",{onClick:b},"view")))},w=function(e){var t=e.message,n=e.messageColor,a={color:n,width:"100vw",border:"3px solid ".concat(n),backgroundColor:"#eee",textAlign:"center",fontSize:"25px"};return r.a.createElement("div",{className:"message"},t&&r.a.createElement("div",{style:a},r.a.createElement("span",null,t)))},O={login:function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},j=function(){var e=Object(a.useState)([]),t=Object(m.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(""),l=Object(m.a)(c,2),p=l[0],b=l[1],f=Object(a.useState)(""),v=Object(m.a)(f,2),g=v[0],j=v[1],k=Object(a.useState)(null),S=Object(m.a)(k,2),y=S[0],x=S[1],C=Object(a.useState)(""),B=Object(m.a)(C,2),N=B[0],A=B[1],T=Object(a.useState)(""),I=Object(m.a)(T,2),J=I[0],L=I[1],z=Object(a.useState)(!1),D=Object(m.a)(z,2),R=D[0],U=D[1],P=Object(a.useState)("New blog"),W=Object(m.a)(P,2),q=W[0],F=W[1],G=function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,O.login({username:p,password:g});case 4:n=e.sent,console.log("user:",n),window.localStorage.setItem("user",JSON.stringify(n)),E.setToken(n.token),x(n),b(""),j(""),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(1),A("Invalid username or password"),L("red"),setTimeout((function(){A(null)}),5e3);case 18:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){E.getAll().then((function(e){return o(e)}))}),[]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("user");if(e){var t=JSON.parse(e);x(t),E.setToken(t.token)}}),[]);var H=function(){var e=Object(s.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.createBlog(t);case 2:a=e.sent,o([].concat(Object(u.a)(n),[a])),A('a new blog "'.concat(t.title,'" by ').concat(t.author," was added")),L("green"),setTimeout((function(){return A(null)}),5e3),U(!1),F("New Blog");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){o(Object(u.a)(n))};return r.a.createElement("div",null,r.a.createElement(w,{message:N,messageColor:J}),y?r.a.createElement("div",null,r.a.createElement("h2",null,"blogs"),r.a.createElement("p",null,"Logged in as ",y.name,r.a.createElement("button",{onClick:function(){window.localStorage.removeItem("user"),x(null)}},"Logout")),R&&r.a.createElement(d,{onBlogAdd:H}),r.a.createElement("button",{onClick:function(){U(!R),F(R?"New Blog":"cancel")}},q),r.a.createElement("div",{className:"blog-list"},n.map((function(e){return r.a.createElement(h,{key:e.id,blog:e,reRenderAfterEvent:K})})))):r.a.createElement("div",null,r.a.createElement("h2",null,"Log in to application"),r.a.createElement("form",{onSubmit:G},r.a.createElement("div",null,"username",r.a.createElement("input",{id:"username",type:"text",value:p,name:"Username",onChange:function(e){var t=e.target;return b(t.value)}})),r.a.createElement("div",null,"password",r.a.createElement("input",{id:"password",type:"password",value:g,name:"Password",onChange:function(e){var t=e.target;return j(t.value)}})),r.a.createElement("button",{id:"login-button",type:"submit"},"login"))))};c.a.render(r.a.createElement(j,null),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.161dba36.chunk.js.map